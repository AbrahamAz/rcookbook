<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 Outputs | R cookbook for analysis with REACH</title>
  <meta name="description" content="8 Outputs | R cookbook for analysis with REACH" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="8 Outputs | R cookbook for analysis with REACH" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 Outputs | R cookbook for analysis with REACH" />
  
  
  

<meta name="author" content="R CoP" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="analysis.html"/>
<link rel="next" href="miscellaneous.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Hello</a></li>
<li class="chapter" data-level="2" data-path="meta-information.html"><a href="meta-information.html"><i class="fa fa-check"></i><b>2</b> Meta information</a>
<ul>
<li class="chapter" data-level="2.1" data-path="meta-information.html"><a href="meta-information.html#creating-the-questionnaire-object"><i class="fa fa-check"></i><b>2.1</b> Creating the questionnaire object</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="downloading-data-from-kobo-server.html"><a href="downloading-data-from-kobo-server.html"><i class="fa fa-check"></i><b>3</b> Downloading data from kobo server</a>
<ul>
<li class="chapter" data-level="3.1" data-path="downloading-data-from-kobo-server.html"><a href="downloading-data-from-kobo-server.html#defining-the-needed-functions"><i class="fa fa-check"></i><b>3.1</b> Defining the needed functions</a></li>
<li class="chapter" data-level="3.2" data-path="downloading-data-from-kobo-server.html"><a href="downloading-data-from-kobo-server.html#creating-data-url-and-credentials-variables"><i class="fa fa-check"></i><b>3.2</b> Creating data url and credentials variables</a></li>
<li class="chapter" data-level="3.3" data-path="downloading-data-from-kobo-server.html"><a href="downloading-data-from-kobo-server.html#fetching-the-data-from-the-server"><i class="fa fa-check"></i><b>3.3</b> Fetching the data from the server</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="pre-analysis.html"><a href="pre-analysis.html"><i class="fa fa-check"></i><b>4</b> Pre analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="pre-analysis.html"><a href="pre-analysis.html#checking-the-xls-kobo-tools-for-constraints-errors"><i class="fa fa-check"></i><b>4.1</b> Checking the XLS kobo tools for constraints errors</a></li>
<li class="chapter" data-level="4.2" data-path="pre-analysis.html"><a href="pre-analysis.html#sampling"><i class="fa fa-check"></i><b>4.2</b> Sampling</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="pre-analysis.html"><a href="pre-analysis.html#simple-random-sampling"><i class="fa fa-check"></i><b>4.2.1</b> Simple Random sampling</a></li>
<li class="chapter" data-level="4.2.2" data-path="pre-analysis.html"><a href="pre-analysis.html#stratified-random-sampling"><i class="fa fa-check"></i><b>4.2.2</b> Stratified Random sampling</a></li>
<li class="chapter" data-level="4.2.3" data-path="pre-analysis.html"><a href="pre-analysis.html#cluster-sampling"><i class="fa fa-check"></i><b>4.2.3</b> Cluster sampling</a></li>
<li class="chapter" data-level="4.2.4" data-path="pre-analysis.html"><a href="pre-analysis.html#stages-random-sampling"><i class="fa fa-check"></i><b>4.2.4</b> 2 stages random sampling</a></li>
<li class="chapter" data-level="4.2.5" data-path="pre-analysis.html"><a href="pre-analysis.html#sample-distribution-usin-population-raster"><i class="fa fa-check"></i><b>4.2.5</b> Sample distribution usin population raster</a></li>
<li class="chapter" data-level="4.2.6" data-path="pre-analysis.html"><a href="pre-analysis.html#generation-of-random-sample-points"><i class="fa fa-check"></i><b>4.2.6</b> Generation of random sample points</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-collection-and-processing.html"><a href="data-collection-and-processing.html"><i class="fa fa-check"></i><b>5</b> Data Collection and Processing</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-collection-and-processing.html"><a href="data-collection-and-processing.html#testing-the-tool"><i class="fa fa-check"></i><b>5.1</b> Testing the tool</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="data-collection-and-processing.html"><a href="data-collection-and-processing.html#creating-dummy-data"><i class="fa fa-check"></i><b>5.1.1</b> Creating dummy data</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="data-collection-and-processing.html"><a href="data-collection-and-processing.html#download-data"><i class="fa fa-check"></i><b>5.2</b> Download data</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="data-collection-and-processing.html"><a href="data-collection-and-processing.html#downloading-audit-files-using-audit_url"><i class="fa fa-check"></i><b>5.2.1</b> Downloading Audit files using audit_URL</a></li>
<li class="chapter" data-level="5.2.2" data-path="data-collection-and-processing.html"><a href="data-collection-and-processing.html#download-audit-files-using-form-name"><i class="fa fa-check"></i><b>5.2.2</b> Download audit files using form name</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="data-collection-and-processing.html"><a href="data-collection-and-processing.html#data-collection-follow-up"><i class="fa fa-check"></i><b>5.3</b> Data collection follow-up</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="data-collection-and-processing.html"><a href="data-collection-and-processing.html#checking-surveys-against-the-sampling-frame"><i class="fa fa-check"></i><b>5.3.1</b> checking surveys against the sampling frame</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="data-collection-and-processing.html"><a href="data-collection-and-processing.html#data-falsification"><i class="fa fa-check"></i><b>5.4</b> Data falsification</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="data-collection-and-processing.html"><a href="data-collection-and-processing.html#check-for-time-in-the-dataset"><i class="fa fa-check"></i><b>5.4.1</b> Check for time (in the dataset)</a></li>
<li class="chapter" data-level="5.4.2" data-path="data-collection-and-processing.html"><a href="data-collection-and-processing.html#check-for-time-audit-files"><i class="fa fa-check"></i><b>5.4.2</b> Check for time (audit files)</a></li>
<li class="chapter" data-level="5.4.3" data-path="data-collection-and-processing.html"><a href="data-collection-and-processing.html#check-for-time---calculating-the-elapsed-time-between-each-interview"><i class="fa fa-check"></i><b>5.4.3</b> Check for time - calculating the elapsed time between each interview</a></li>
<li class="chapter" data-level="5.4.4" data-path="data-collection-and-processing.html"><a href="data-collection-and-processing.html#silouhette-analysis"><i class="fa fa-check"></i><b>5.4.4</b> Silouhette analysis</a></li>
<li class="chapter" data-level="5.4.5" data-path="data-collection-and-processing.html"><a href="data-collection-and-processing.html#check-for-duplicates"><i class="fa fa-check"></i><b>5.4.5</b> Check for duplicates</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="data-collection-and-processing.html"><a href="data-collection-and-processing.html#data-checks"><i class="fa fa-check"></i><b>5.5</b> Data checks</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="data-collection-and-processing.html"><a href="data-collection-and-processing.html#check-for-outliers"><i class="fa fa-check"></i><b>5.5.1</b> Check for outliers</a></li>
<li class="chapter" data-level="5.5.2" data-path="data-collection-and-processing.html"><a href="data-collection-and-processing.html#check-others"><i class="fa fa-check"></i><b>5.5.2</b> Check others</a></li>
<li class="chapter" data-level="5.5.3" data-path="data-collection-and-processing.html"><a href="data-collection-and-processing.html#check-for-logical-check"><i class="fa fa-check"></i><b>5.5.3</b> Check for logical check</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="data-collection-and-processing.html"><a href="data-collection-and-processing.html#cleaninginspector---inspect_all"><i class="fa fa-check"></i><b>5.6</b> cleaninginspectoR - inspect_all</a></li>
<li class="chapter" data-level="5.7" data-path="data-collection-and-processing.html"><a href="data-collection-and-processing.html#data-cleaning"><i class="fa fa-check"></i><b>5.7</b> Data cleaning</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="data-collection-and-processing.html"><a href="data-collection-and-processing.html#re-generate-text-column-for-select-multiple-questions"><i class="fa fa-check"></i><b>5.7.1</b> Re-generate text column for select multiple questions</a></li>
<li class="chapter" data-level="5.7.2" data-path="data-collection-and-processing.html"><a href="data-collection-and-processing.html#clean-data-base-on-cleaning-log"><i class="fa fa-check"></i><b>5.7.2</b> Clean data base on cleaning log</a></li>
<li class="chapter" data-level="5.7.3" data-path="data-collection-and-processing.html"><a href="data-collection-and-processing.html#check-cleaning-log-raw-dataset-and-clean-dataset"><i class="fa fa-check"></i><b>5.7.3</b> Check cleaning log, raw dataset and clean dataset</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="data-collection-and-processing.html"><a href="data-collection-and-processing.html#data-cleaning---miscellaneous"><i class="fa fa-check"></i><b>5.8</b> Data cleaning - miscellaneous</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="data-collection-and-processing.html"><a href="data-collection-and-processing.html#check-for-data-sanity-check-if-the-data-follow-odk-format-select_one-select_multiple-xxx-choices"><i class="fa fa-check"></i><b>5.8.1</b> Check for data sanity check if the data follow ODK format (select_one, select_multiple, xxx, choices)</a></li>
<li class="chapter" data-level="5.8.2" data-path="data-collection-and-processing.html"><a href="data-collection-and-processing.html#turns-label-to-xml"><i class="fa fa-check"></i><b>5.8.2</b> Turns label to xml</a></li>
<li class="chapter" data-level="5.8.3" data-path="data-collection-and-processing.html"><a href="data-collection-and-processing.html#statistical-disclosure-control-methods"><i class="fa fa-check"></i><b>5.8.3</b> Statistical Disclosure Control Methods</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="data-collection-and-processing.html"><a href="data-collection-and-processing.html#spatial-verification-checks"><i class="fa fa-check"></i><b>5.9</b> Spatial verification checks</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="data-collection-and-processing.html"><a href="data-collection-and-processing.html#spatial-verification-checks-on-settlement-level"><i class="fa fa-check"></i><b>5.9.1</b> Spatial verification checks on settlement level</a></li>
<li class="chapter" data-level="5.9.2" data-path="data-collection-and-processing.html"><a href="data-collection-and-processing.html#spatial-verification-checks-on-sample-point-level"><i class="fa fa-check"></i><b>5.9.2</b> Spatial verification checks on sample point level</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="composite-indicators.html"><a href="composite-indicators.html"><i class="fa fa-check"></i><b>6</b> Composite indicators</a>
<ul>
<li class="chapter" data-level="6.1" data-path="composite-indicators.html"><a href="composite-indicators.html#composite-with-1-categorical-variable---select-one"><i class="fa fa-check"></i><b>6.1</b> Composite with 1 categorical variable - select one</a></li>
<li class="chapter" data-level="6.2" data-path="composite-indicators.html"><a href="composite-indicators.html#composite-with-2-categorical-variables"><i class="fa fa-check"></i><b>6.2</b> Composite with 2 categorical variables</a></li>
<li class="chapter" data-level="6.3" data-path="composite-indicators.html"><a href="composite-indicators.html#composite-with-1-categorical-variable---select-multiple"><i class="fa fa-check"></i><b>6.3</b> Composite with 1 categorical variable - select multiple</a></li>
<li class="chapter" data-level="6.4" data-path="composite-indicators.html"><a href="composite-indicators.html#composite-with-1-numerical-variable"><i class="fa fa-check"></i><b>6.4</b> Composite with 1 numerical variable</a></li>
<li class="chapter" data-level="6.5" data-path="composite-indicators.html"><a href="composite-indicators.html#composite-with-2-numerical-variables"><i class="fa fa-check"></i><b>6.5</b> Composite with 2 numerical variables</a></li>
<li class="chapter" data-level="6.6" data-path="composite-indicators.html"><a href="composite-indicators.html#composite-with-2-or-more-numerical-variables"><i class="fa fa-check"></i><b>6.6</b> Composite with 2 or more numerical variables</a></li>
<li class="chapter" data-level="6.7" data-path="composite-indicators.html"><a href="composite-indicators.html#new-indicators-from-a-loop-to-main-dataset"><i class="fa fa-check"></i><b>6.7</b> New indicators from a loop to main dataset</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="analysis.html"><a href="analysis.html"><i class="fa fa-check"></i><b>7</b> Analysis</a>
<ul>
<li class="chapter" data-level="7.1" data-path="analysis.html"><a href="analysis.html#hypegrammar"><i class="fa fa-check"></i><b>7.1</b> hypegrammaR</a></li>
<li class="chapter" data-level="7.2" data-path="analysis.html"><a href="analysis.html#srvyr-package"><i class="fa fa-check"></i><b>7.2</b> srvyr package</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="analysis.html"><a href="analysis.html#categorical-variables"><i class="fa fa-check"></i><b>7.2.1</b> Categorical variables</a></li>
<li class="chapter" data-level="7.2.2" data-path="analysis.html"><a href="analysis.html#numeric-variables"><i class="fa fa-check"></i><b>7.2.2</b> Numeric variables</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="analysis.html"><a href="analysis.html#butter-survey_collapse"><i class="fa fa-check"></i><b>7.3</b> butteR survey_collapse</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="analysis.html"><a href="analysis.html#select_one"><i class="fa fa-check"></i><b>7.3.1</b> select_one</a></li>
<li class="chapter" data-level="7.3.2" data-path="analysis.html"><a href="analysis.html#select_mutiple"><i class="fa fa-check"></i><b>7.3.2</b> select_mutiple</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="analysis.html"><a href="analysis.html#analysis-with-numerical-variables"><i class="fa fa-check"></i><b>7.4</b> Analysis with numerical variables</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="analysis.html"><a href="analysis.html#averages"><i class="fa fa-check"></i><b>7.4.1</b> Averages</a></li>
<li class="chapter" data-level="7.4.2" data-path="analysis.html"><a href="analysis.html#median"><i class="fa fa-check"></i><b>7.4.2</b> Median</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="analysis.html"><a href="analysis.html#ratios"><i class="fa fa-check"></i><b>7.5</b> Ratios</a>
<ul>
<li><a href="analysis.html#example1"><span class="toc-section-number">7.5.1</span> Example1:<br />
</a></li>
<li><a href="analysis.html#example2---analyzing-multiple-questions-and-combine-the-output"><span class="toc-section-number">7.5.2</span> Example2 - Analyzing multiple questions and combine the output:<br />
</a></li>
<li><a href="analysis.html#example3---no-dissagregation-is-needed-andor-the-data-is-not-weighted"><span class="toc-section-number">7.5.3</span> Example3 - No dissagregation is needed and/or the data is not weighted:<br />
</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="analysis.html"><a href="analysis.html#weights"><i class="fa fa-check"></i><b>7.6</b> Weights</a></li>
<li class="chapter" data-level="7.7" data-path="analysis.html"><a href="analysis.html#repeating-the-above"><i class="fa fa-check"></i><b>7.7</b> Repeating the above</a></li>
<li class="chapter" data-level="7.8" data-path="analysis.html"><a href="analysis.html#analysis---top-x-ranking-select-one-and-select-multiple"><i class="fa fa-check"></i><b>7.8</b> Analysis - top X / ranking (select one and select multiple)</a></li>
<li class="chapter" data-level="7.9" data-path="analysis.html"><a href="analysis.html#borda-count"><i class="fa fa-check"></i><b>7.9</b> Borda count</a></li>
<li class="chapter" data-level="7.10" data-path="analysis.html"><a href="analysis.html#hypothesis-testing"><i class="fa fa-check"></i><b>7.10</b> Hypothesis testing</a>
<ul>
<li class="chapter" data-level="7.10.1" data-path="analysis.html"><a href="analysis.html#t-test"><i class="fa fa-check"></i><b>7.10.1</b> T-test</a></li>
<li class="chapter" data-level="7.10.2" data-path="analysis.html"><a href="analysis.html#anova"><i class="fa fa-check"></i><b>7.10.2</b> ANOVA</a></li>
<li class="chapter" data-level="7.10.3" data-path="analysis.html"><a href="analysis.html#chi-squares"><i class="fa fa-check"></i><b>7.10.3</b> chi-squares</a></li>
<li class="chapter" data-level="7.10.4" data-path="analysis.html"><a href="analysis.html#chi-squared-goodness-of-fit-test"><i class="fa fa-check"></i><b>7.10.4</b> Chi-squared Goodness of Fit test</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="outputs.html"><a href="outputs.html"><i class="fa fa-check"></i><b>8</b> Outputs</a>
<ul>
<li class="chapter" data-level="8.1" data-path="outputs.html"><a href="outputs.html#from-long-to-large-table"><i class="fa fa-check"></i><b>8.1</b> From long to large table</a></li>
<li class="chapter" data-level="8.2" data-path="outputs.html"><a href="outputs.html#merge-file"><i class="fa fa-check"></i><b>8.2</b> Merge file</a></li>
<li class="chapter" data-level="8.3" data-path="outputs.html"><a href="outputs.html#graphs"><i class="fa fa-check"></i><b>8.3</b> Graphs</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="outputs.html"><a href="outputs.html#spider-graphs"><i class="fa fa-check"></i><b>8.3.1</b> spider graphs</a></li>
<li class="chapter" data-level="8.3.2" data-path="outputs.html"><a href="outputs.html#prison-graphs"><i class="fa fa-check"></i><b>8.3.2</b> prison graphs</a></li>
<li class="chapter" data-level="8.3.3" data-path="outputs.html"><a href="outputs.html#bar-graphs"><i class="fa fa-check"></i><b>8.3.3</b> Bar graphs</a></li>
<li class="chapter" data-level="8.3.4" data-path="outputs.html"><a href="outputs.html#euler-diagram"><i class="fa fa-check"></i><b>8.3.4</b> Euler diagram</a></li>
<li class="chapter" data-level="8.3.5" data-path="outputs.html"><a href="outputs.html#venn-diagram"><i class="fa fa-check"></i><b>8.3.5</b> Venn diagram</a></li>
<li class="chapter" data-level="8.3.6" data-path="outputs.html"><a href="outputs.html#upset-plots"><i class="fa fa-check"></i><b>8.3.6</b> UpSet plots</a></li>
<li class="chapter" data-level="8.3.7" data-path="outputs.html"><a href="outputs.html#boxplots"><i class="fa fa-check"></i><b>8.3.7</b> boxplots</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="outputs.html"><a href="outputs.html#labels"><i class="fa fa-check"></i><b>8.4</b> Labels</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="outputs.html"><a href="outputs.html#change-from-xml-to-label"><i class="fa fa-check"></i><b>8.4.1</b> change from xml to label</a></li>
<li class="chapter" data-level="8.4.2" data-path="outputs.html"><a href="outputs.html#change-from-label-to-xml"><i class="fa fa-check"></i><b>8.4.2</b> change from label to xml</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="outputs.html"><a href="outputs.html#dashboarding---sharing-information"><i class="fa fa-check"></i><b>8.5</b> Dashboarding - Sharing information</a></li>
<li class="chapter" data-level="8.6" data-path="outputs.html"><a href="outputs.html#outputs-with-hypothesis-testing-results"><i class="fa fa-check"></i><b>8.6</b> Outputs with hypothesis testing results</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="miscellaneous.html"><a href="miscellaneous.html"><i class="fa fa-check"></i><b>9</b> Miscellaneous</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R cookbook for analysis with REACH</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="outputs" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Outputs</h1>
<div id="from-long-to-large-table" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> From long to large table</h2>
<p>How to move from a tidy format to a large format</p>
</div>
<div id="merge-file" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> Merge file</h2>
<p>How to create a merge file</p>
</div>
<div id="graphs" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> Graphs</h2>
<div id="spider-graphs" class="section level3" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> spider graphs</h3>
</div>
<div id="prison-graphs" class="section level3" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> prison graphs</h3>
</div>
<div id="bar-graphs" class="section level3" number="8.3.3">
<h3><span class="header-section-number">8.3.3</span> Bar graphs</h3>
<p>Loading libraries and the main dataset</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="outputs.html#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb222-2"><a href="outputs.html#cb222-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb222-3"><a href="outputs.html#cb222-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;plotly&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:Hmisc&#39;:
## 
##     subplot</code></pre>
<pre><code>## The following object is masked from &#39;package:httr&#39;:
## 
##     config</code></pre>
<pre><code>## The following object is masked from &#39;package:crayon&#39;:
## 
##     style</code></pre>
<pre><code>## The following object is masked from &#39;package:ggplot2&#39;:
## 
##     last_plot</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     filter</code></pre>
<pre><code>## The following object is masked from &#39;package:graphics&#39;:
## 
##     layout</code></pre>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="outputs.html#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb230-2"><a href="outputs.html#cb230-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;data.table&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:spatstat.geom&#39;:
## 
##     shift</code></pre>
<pre><code>## The following objects are masked from &#39;package:expss&#39;:
## 
##     copy, like</code></pre>
<pre><code>## The following objects are masked from &#39;package:lubridate&#39;:
## 
##     hour, isoweek, mday, minute, month, quarter, second, wday, week,
##     yday, year</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     transpose</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     between, first, last</code></pre>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="outputs.html#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;reshape&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:data.table&#39;:
## 
##     melt</code></pre>
<pre><code>## The following object is masked from &#39;package:plotly&#39;:
## 
##     rename</code></pre>
<pre><code>## The following object is masked from &#39;package:srvyr&#39;:
## 
##     rename</code></pre>
<pre><code>## The following object is masked from &#39;package:lubridate&#39;:
## 
##     stamp</code></pre>
<pre><code>## The following objects are masked from &#39;package:tidyr&#39;:
## 
##     expand, smiths</code></pre>
<pre><code>## The following object is masked from &#39;package:Matrix&#39;:
## 
##     expand</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     rename</code></pre>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="outputs.html#cb246-1" aria-hidden="true" tabindex="-1"></a>main_dataset <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;inputs/UKR2007_MSNA20_HH_dataset_main_rcop.csv&quot;</span>, <span class="at">na.strings =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p>Choosing the needed indicator for building bar graph. The indicators in the questionnaire could be in 2 types: Only one answer can be selected (select_one question) and multiple answers can be selected (select_multiple question). Will review it separately.</p>
<ol style="list-style-type: decimal">
<li>For select one questions:</li>
</ol>
<p>Preparing values for visualization (replacing xml values to lables)</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="outputs.html#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading questionnaire</span></span>
<span id="cb247-2"><a href="outputs.html#cb247-2" aria-hidden="true" tabindex="-1"></a>questions <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">&quot;inputs/UKR2007_MSNA20_HH_Questionnaire_24JUL2020.xlsx&quot;</span>, <span class="at">sheet =</span> <span class="st">&quot;survey&quot;</span>, <span class="at">na.strings =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb247-3"><a href="outputs.html#cb247-3" aria-hidden="true" tabindex="-1"></a>choices <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">&quot;inputs/UKR2007_MSNA20_HH_Questionnaire_24JUL2020.xlsx&quot;</span>, <span class="at">sheet =</span> <span class="st">&quot;choices&quot;</span>, <span class="at">na.strings =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb247-4"><a href="outputs.html#cb247-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-5"><a href="outputs.html#cb247-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Based on value we get option type</span></span>
<span id="cb247-6"><a href="outputs.html#cb247-6" aria-hidden="true" tabindex="-1"></a>q.list_name <span class="ot">&lt;-</span> <span class="fu">str_split</span>(questions[questions<span class="sc">$</span>name <span class="sc">==</span> <span class="st">&quot;b9_hohh_marital_status&quot;</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(questions<span class="sc">$</span>name), <span class="st">&quot;type&quot;</span>], <span class="st">&quot; &quot;</span>)[[<span class="dv">1</span>]][<span class="dv">2</span>]</span>
<span id="cb247-7"><a href="outputs.html#cb247-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-8"><a href="outputs.html#cb247-8" aria-hidden="true" tabindex="-1"></a><span class="co"># New table with xml and labels</span></span>
<span id="cb247-9"><a href="outputs.html#cb247-9" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> choices <span class="sc">%&gt;%</span></span>
<span id="cb247-10"><a href="outputs.html#cb247-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(list_name <span class="sc">==</span> q.list_name) <span class="sc">%&gt;%</span></span>
<span id="cb247-11"><a href="outputs.html#cb247-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, <span class="st">&quot;label::English&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb247-12"><a href="outputs.html#cb247-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">b9_hohh_marital_status =</span> name, <span class="at">b9_hohh_marital_status_label =</span> <span class="st">&quot;label::English&quot;</span>)</span>
<span id="cb247-13"><a href="outputs.html#cb247-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-14"><a href="outputs.html#cb247-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a column with English labels to the main dataset</span></span>
<span id="cb247-15"><a href="outputs.html#cb247-15" aria-hidden="true" tabindex="-1"></a>main_dataset <span class="ot">&lt;-</span> <span class="fu">merge</span>(labels, main_dataset, <span class="at">by =</span> <span class="st">&#39;b9_hohh_marital_status&#39;</span>)</span></code></pre></div>
<p>Building a bar graph</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="outputs.html#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>((main_dataset <span class="sc">%&gt;%</span></span>
<span id="cb248-2"><a href="outputs.html#cb248-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(b9_hohh_marital_status_label)) <span class="sc">%&gt;%</span></span>
<span id="cb248-3"><a href="outputs.html#cb248-3" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">group_by</span>(b9_hohh_marital_status_label) <span class="sc">%&gt;%</span></span>
<span id="cb248-4"><a href="outputs.html#cb248-4" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">weight_sum =</span> <span class="fu">round</span>(<span class="fu">sum</span>(stratum.weight), <span class="dv">2</span>))), <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">reorder</span>(b9_hohh_marital_status_label, weight_sum), <span class="at">x =</span> weight_sum<span class="sc">/</span><span class="fu">sum</span>(weight_sum))) <span class="sc">+</span></span>
<span id="cb248-5"><a href="outputs.html#cb248-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;#EE5859&quot;</span>) <span class="sc">+</span></span>
<span id="cb248-6"><a href="outputs.html#cb248-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">round</span>((weight_sum<span class="sc">/</span><span class="fu">sum</span>(weight_sum)<span class="sc">*</span><span class="dv">100</span>),<span class="dv">0</span>),<span class="st">&quot;%&quot;</span>)), <span class="at">color =</span> <span class="st">&quot;#58585A&quot;</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb248-7"><a href="outputs.html#cb248-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">+</span></span>
<span id="cb248-8"><a href="outputs.html#cb248-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(), <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(), <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(), <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;#58585A&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb248-9"><a href="outputs.html#cb248-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(), <span class="at">panel.background =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-134-1.png" width="672" /></p>
<p>Removing temporary data</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="outputs.html#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(labels, q.list_name)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>For select multiple questions:</li>
</ol>
<p>Preparing values for visualization (replacing xml values to lables; calculating results)</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="outputs.html#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Getting needed columns from the main dataset (indicator and weight)</span></span>
<span id="cb250-2"><a href="outputs.html#cb250-2" aria-hidden="true" tabindex="-1"></a>visual_dataset <span class="ot">&lt;-</span> main_dataset[,<span class="fu">grepl</span>(<span class="st">&quot;b10_hohh_vulnerability.|stratum.weight&quot;</span>, <span class="fu">names</span>(main_dataset))]</span>
<span id="cb250-3"><a href="outputs.html#cb250-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-4"><a href="outputs.html#cb250-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshaping the dataset</span></span>
<span id="cb250-5"><a href="outputs.html#cb250-5" aria-hidden="true" tabindex="-1"></a>visual_dataset <span class="ot">&lt;-</span> <span class="fu">melt</span>(visual_dataset, <span class="at">id.vars =</span> <span class="st">&quot;stratum.weight&quot;</span>)</span>
<span id="cb250-6"><a href="outputs.html#cb250-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-7"><a href="outputs.html#cb250-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Grouping by choices and getting sum of weights</span></span>
<span id="cb250-8"><a href="outputs.html#cb250-8" aria-hidden="true" tabindex="-1"></a>visual_dataset <span class="ot">&lt;-</span> visual_dataset <span class="sc">%&gt;%</span></span>
<span id="cb250-9"><a href="outputs.html#cb250-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weight =</span> stratum.weight <span class="sc">*</span> value) <span class="sc">%&gt;%</span></span>
<span id="cb250-10"><a href="outputs.html#cb250-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(variable) <span class="sc">%&gt;%</span> </span>
<span id="cb250-11"><a href="outputs.html#cb250-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">weight_sum =</span> <span class="fu">sum</span>(<span class="fu">as.numeric</span>(weight))) <span class="sc">%&gt;%</span></span>
<span id="cb250-12"><a href="outputs.html#cb250-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> <span class="fu">round</span>(weight_sum <span class="sc">/</span> <span class="fu">sum</span>(main_dataset<span class="sc">$</span>stratum.weight)<span class="sc">*</span><span class="dv">100</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb250-13"><a href="outputs.html#cb250-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">b10_hohh_vulnerability =</span> variable)</span>
<span id="cb250-14"><a href="outputs.html#cb250-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-15"><a href="outputs.html#cb250-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Based on value we get option type and replacing xmls to the labels and </span></span>
<span id="cb250-16"><a href="outputs.html#cb250-16" aria-hidden="true" tabindex="-1"></a>q.list_name <span class="ot">&lt;-</span> <span class="fu">str_split</span>(questions[questions<span class="sc">$</span>name <span class="sc">==</span> <span class="st">&quot;b10_hohh_vulnerability&quot;</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(questions<span class="sc">$</span>name), <span class="st">&quot;type&quot;</span>], <span class="st">&quot; &quot;</span>)[[<span class="dv">1</span>]][<span class="dv">2</span>]</span>
<span id="cb250-17"><a href="outputs.html#cb250-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-18"><a href="outputs.html#cb250-18" aria-hidden="true" tabindex="-1"></a><span class="co"># New table with xml and labels</span></span>
<span id="cb250-19"><a href="outputs.html#cb250-19" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> choices <span class="sc">%&gt;%</span></span>
<span id="cb250-20"><a href="outputs.html#cb250-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(list_name <span class="sc">==</span> q.list_name) <span class="sc">%&gt;%</span></span>
<span id="cb250-21"><a href="outputs.html#cb250-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, <span class="st">&quot;label::English&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb250-22"><a href="outputs.html#cb250-22" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">b10_hohh_vulnerability =</span> name, <span class="at">b10_hohh_vulnerability_label =</span> <span class="st">&quot;label::English&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb250-23"><a href="outputs.html#cb250-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">b10_hohh_vulnerability =</span> <span class="fu">paste0</span>(<span class="st">&quot;b10_hohh_vulnerability.&quot;</span>, b10_hohh_vulnerability))</span>
<span id="cb250-24"><a href="outputs.html#cb250-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-25"><a href="outputs.html#cb250-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a column with English labels to the visualization dataset</span></span>
<span id="cb250-26"><a href="outputs.html#cb250-26" aria-hidden="true" tabindex="-1"></a>visual_dataset <span class="ot">&lt;-</span> <span class="fu">merge</span>(labels, visual_dataset, <span class="at">by =</span> <span class="st">&#39;b10_hohh_vulnerability&#39;</span>)</span></code></pre></div>
<p>Building a bar graph</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="outputs.html#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(visual_dataset, <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">reorder</span>(b10_hohh_vulnerability_label, percentage), <span class="at">x =</span> percentage)) <span class="sc">+</span></span>
<span id="cb251-2"><a href="outputs.html#cb251-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;#EE5859&quot;</span>) <span class="sc">+</span></span>
<span id="cb251-3"><a href="outputs.html#cb251-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(percentage, <span class="st">&quot;%&quot;</span>)), <span class="at">color =</span> <span class="st">&quot;#58585A&quot;</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb251-4"><a href="outputs.html#cb251-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">+</span></span>
<span id="cb251-5"><a href="outputs.html#cb251-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(), <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(), <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(), <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;#58585A&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb251-6"><a href="outputs.html#cb251-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(), <span class="at">panel.background =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-137-1.png" width="672" /></p>
<p>Removing temporary data</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="outputs.html#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(labels, q.list_name)</span></code></pre></div>
</div>
<div id="euler-diagram" class="section level3" number="8.3.4">
<h3><span class="header-section-number">8.3.4</span> Euler diagram</h3>
<p><em>An Euler diagram is a diagrammatic means of representing sets and their relationships. They are particularly useful for explaining complex hierarchies and overlapping definitions. They are similar to another set diagramming technique, Venn diagrams. Unlike Venn diagrams, which show all possible relations between different sets, the Euler diagram shows only relevant relationships. <a href="https://en.wikipedia.org/wiki/Euler_diagram">Source</a></em></p>
<p>First let’s load <a href="https://cran.r-project.org/web/packages/eulerr/vignettes/introduction.html">Eulerr library</a> and our dataset</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="outputs.html#cb253-1" aria-hidden="true" tabindex="-1"></a>main_dataset <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;inputs/UKR2007_MSNA20_HH_dataset_main_rcop.csv&quot;</span>, <span class="at">na.strings =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p>Euler diagrams are particularly useful to visualize overlaps between HH characteristics that help better understand the demographic profile of the area. For example, let’s visualize overlaps between such HH characteristics as age, displacement status, income level, disability, and employment status.</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="outputs.html#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(eulerr)</span>
<span id="cb254-2"><a href="outputs.html#cb254-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb254-3"><a href="outputs.html#cb254-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb254-4"><a href="outputs.html#cb254-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb254-5"><a href="outputs.html#cb254-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb254-6"><a href="outputs.html#cb254-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb254-7"><a href="outputs.html#cb254-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb254-8"><a href="outputs.html#cb254-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(UpSetR)</span>
<span id="cb254-9"><a href="outputs.html#cb254-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-10"><a href="outputs.html#cb254-10" aria-hidden="true" tabindex="-1"></a>vulnerability_data <span class="ot">&lt;-</span> main_dataset <span class="sc">%&gt;%</span></span>
<span id="cb254-11"><a href="outputs.html#cb254-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(b10_hohh_vulnerability.disability_not_including_chronic_illness,b10_hohh_vulnerability.older_person,</span>
<span id="cb254-12"><a href="outputs.html#cb254-12" aria-hidden="true" tabindex="-1"></a>           b10_hohh_vulnerability.unemployed,d1_hh_displacement_status,b15_hohh_income,X_uuid, strata, stratum.weight)<span class="sc">%&gt;%</span></span>
<span id="cb254-13"><a href="outputs.html#cb254-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">#select all necessary columns</span></span>
<span id="cb254-14"><a href="outputs.html#cb254-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">displaced =</span> <span class="fu">ifelse</span>(d1_hh_displacement_status <span class="sc">==</span> <span class="st">&quot;no&quot;</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb254-15"><a href="outputs.html#cb254-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">low_income =</span> <span class="fu">ifelse</span>(<span class="fu">as.numeric</span>(b15_hohh_income) <span class="sc">&gt;=</span> <span class="dv">2189</span>, <span class="dv">0</span>, <span class="dv">1</span>))<span class="sc">%&gt;%</span> <span class="co">#2189 UAH(83$) is minimal monthly income in 2020</span></span>
<span id="cb254-16"><a href="outputs.html#cb254-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#calculate binary indicators in case they are not available in the dataset directly from select multiple questions</span></span>
<span id="cb254-17"><a href="outputs.html#cb254-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>d1_hh_displacement_status, <span class="sc">-</span>b15_hohh_income)<span class="sc">%&gt;%</span></span>
<span id="cb254-18"><a href="outputs.html#cb254-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">&quot;disability&quot;</span>, <span class="st">&quot;60+&quot;</span>, <span class="st">&quot;unemployed&quot;</span>, <span class="st">&quot;uuid&quot;</span>, <span class="st">&quot;strata&quot;</span>, <span class="st">&quot;weight&quot;</span>, <span class="st">&quot;displaced&quot;</span>, <span class="st">&quot;low_income&quot;</span>))</span>
<span id="cb254-19"><a href="outputs.html#cb254-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#remove unnecessary columns and rename other column</span></span>
<span id="cb254-20"><a href="outputs.html#cb254-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-21"><a href="outputs.html#cb254-21" aria-hidden="true" tabindex="-1"></a>vulnerability_data <span class="ot">&lt;-</span> <span class="co">#create column that will combine all binary columns into one (same approach as in </span><span class="al">###</span><span class="co"> Re-generate text                             column  for select multiple questions section of Data Cleaning chapter)</span></span>
<span id="cb254-22"><a href="outputs.html#cb254-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map2_df</span>(vulnerability_data, <span class="fu">names</span>(vulnerability_data), <span class="sc">~</span>  <span class="fu">replace</span>(.x, .x<span class="sc">==</span><span class="dv">1</span>, .y) <span class="sc">%&gt;%</span> </span>
<span id="cb254-23"><a href="outputs.html#cb254-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">replace</span>(. <span class="sc">==</span> <span class="dv">0</span>, <span class="cn">NA</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb254-24"><a href="outputs.html#cb254-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unite</span>(combined, disability, <span class="st">`</span><span class="at">60+</span><span class="st">`</span>, displaced, low_income, unemployed, <span class="at">remove =</span> <span class="cn">FALSE</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">&#39;&amp;&#39;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb254-25"><a href="outputs.html#cb254-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>combined <span class="sc">==</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb254-26"><a href="outputs.html#cb254-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-27"><a href="outputs.html#cb254-27" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate weighted summary statistics for each combination</span></span>
<span id="cb254-28"><a href="outputs.html#cb254-28" aria-hidden="true" tabindex="-1"></a>vulnerability_summary <span class="ot">&lt;-</span> vulnerability_data <span class="sc">%&gt;%</span></span>
<span id="cb254-29"><a href="outputs.html#cb254-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(strata, weight, combined)<span class="sc">%&gt;%</span> </span>
<span id="cb254-30"><a href="outputs.html#cb254-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(combined) <span class="sc">%&gt;%</span> </span>
<span id="cb254-31"><a href="outputs.html#cb254-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">weight_sum =</span> <span class="fu">sum</span>(<span class="fu">as.numeric</span>(weight)))<span class="sc">%&gt;%</span></span>
<span id="cb254-32"><a href="outputs.html#cb254-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">per =</span> weight_sum <span class="sc">/</span> <span class="fu">sum</span>(weight_sum) <span class="sc">*</span> <span class="dv">100</span>)<span class="sc">%&gt;%</span></span>
<span id="cb254-33"><a href="outputs.html#cb254-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(per <span class="sc">&gt;</span> <span class="dv">1</span>)<span class="sc">%&gt;%</span></span>
<span id="cb254-34"><a href="outputs.html#cb254-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>weight_sum)</span>
<span id="cb254-35"><a href="outputs.html#cb254-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-36"><a href="outputs.html#cb254-36" aria-hidden="true" tabindex="-1"></a><span class="co">#convert data frame into named numeric vector that is used by plot function</span></span>
<span id="cb254-37"><a href="outputs.html#cb254-37" aria-hidden="true" tabindex="-1"></a>vulnerability_input <span class="ot">&lt;-</span>  vulnerability_summary <span class="sc">%&gt;%</span></span>
<span id="cb254-38"><a href="outputs.html#cb254-38" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">deframe</span>()</span></code></pre></div>
<p>In this block we will build euler diagram using REACH color palette and some basic styling.</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="outputs.html#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">euler</span>(vulnerability_input),</span>
<span id="cb255-2"><a href="outputs.html#cb255-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">edges =</span> <span class="cn">FALSE</span>,</span>
<span id="cb255-3"><a href="outputs.html#cb255-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">quantities =</span> <span class="fu">list</span>(<span class="at">type =</span> <span class="st">&quot;percent&quot;</span>, <span class="at">fontsize =</span> <span class="dv">8</span>),</span>
<span id="cb255-4"><a href="outputs.html#cb255-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;60+&quot;</span>, <span class="st">&quot;Displaced&quot;</span>, <span class="st">&quot;Low income&quot;</span>, <span class="st">&quot;Disability&quot;</span>, <span class="st">&quot;Unemployed&quot;</span>),</span>
<span id="cb255-5"><a href="outputs.html#cb255-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">legend =</span> <span class="fu">list</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;60+&quot;</span>, <span class="st">&quot;Displaced&quot;</span>, <span class="st">&quot;Low income&quot;</span>, <span class="st">&quot;Disability&quot;</span>, <span class="st">&quot;Unemployed&quot;</span>)),</span>
<span id="cb255-6"><a href="outputs.html#cb255-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">fills =</span> <span class="fu">c</span>(<span class="st">&quot;#7CB6C4&quot;</span>,<span class="st">&quot;#B6C8B1&quot;</span>,<span class="st">&quot;#F6E3E3&quot;</span>,<span class="st">&quot;#D1CAB8&quot;</span>,<span class="st">&quot;#D1D3D4&quot;</span>)</span>
<span id="cb255-7"><a href="outputs.html#cb255-7" aria-hidden="true" tabindex="-1"></a>     )</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-141-1.png" width="672" /></p>
<p>As an alternative, we also can build a Venn diagram that shows each relation (even not possible in reality). As you can see Venn diagram in this case is less readable and usable.</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="outputs.html#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">venn</span>(vulnerability_input),</span>
<span id="cb256-2"><a href="outputs.html#cb256-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">edges =</span> <span class="cn">FALSE</span>,</span>
<span id="cb256-3"><a href="outputs.html#cb256-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">quantities =</span> <span class="fu">list</span>(<span class="at">type =</span> <span class="st">&quot;percent&quot;</span>, <span class="at">fontsize =</span> <span class="dv">8</span>), </span>
<span id="cb256-4"><a href="outputs.html#cb256-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;60+&quot;</span>, <span class="st">&quot;Displaced&quot;</span>, <span class="st">&quot;Low income&quot;</span>, <span class="st">&quot;Disability&quot;</span>, <span class="st">&quot;Unemployed&quot;</span>),</span>
<span id="cb256-5"><a href="outputs.html#cb256-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">legend =</span> <span class="fu">list</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;60+&quot;</span>, <span class="st">&quot;Displaced&quot;</span>, <span class="st">&quot;Low income&quot;</span>, <span class="st">&quot;Disability&quot;</span>, <span class="st">&quot;Unemployed&quot;</span>)),</span>
<span id="cb256-6"><a href="outputs.html#cb256-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">fills =</span> <span class="fu">c</span>(<span class="st">&quot;#7CB6C4&quot;</span>,<span class="st">&quot;#B6C8B1&quot;</span>,<span class="st">&quot;#F6E3E3&quot;</span>,<span class="st">&quot;#D1CAB8&quot;</span>,<span class="st">&quot;#D1D3D4&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-142-1.png" width="672" />
Another popular type of diagram that shows relation is <a href="https://github.com/hms-dbmi/UpSetR">UpSetR diagram</a>. Even with default styling, it’s quite good in the visualization of intersections between different HH characteristics.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="outputs.html#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(<span class="fu">fromExpression</span>(vulnerability_input), <span class="at">order.by =</span> <span class="st">&quot;freq&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-143-1.png" width="672" /></p>
</div>
<div id="venn-diagram" class="section level3" number="8.3.5">
<h3><span class="header-section-number">8.3.5</span> Venn diagram</h3>
</div>
<div id="upset-plots" class="section level3" number="8.3.6">
<h3><span class="header-section-number">8.3.6</span> UpSet plots</h3>
</div>
<div id="boxplots" class="section level3" number="8.3.7">
<h3><span class="header-section-number">8.3.7</span> boxplots</h3>
</div>
</div>
<div id="labels" class="section level2" number="8.4">
<h2><span class="header-section-number">8.4</span> Labels</h2>
<div id="change-from-xml-to-label" class="section level3" number="8.4.1">
<h3><span class="header-section-number">8.4.1</span> change from xml to label</h3>
</div>
<div id="change-from-label-to-xml" class="section level3" number="8.4.2">
<h3><span class="header-section-number">8.4.2</span> change from label to xml</h3>
</div>
</div>
<div id="dashboarding---sharing-information" class="section level2" number="8.5">
<h2><span class="header-section-number">8.5</span> Dashboarding - Sharing information</h2>
<p>Html files
Tableau
Power BI
Shiny</p>
</div>
<div id="outputs-with-hypothesis-testing-results" class="section level2" number="8.6">
<h2><span class="header-section-number">8.6</span> Outputs with hypothesis testing results</h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="miscellaneous.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
