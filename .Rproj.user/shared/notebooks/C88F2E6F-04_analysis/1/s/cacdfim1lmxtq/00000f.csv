"0","non_zero_for_test <- function(var, strata, dataset, per_cell = F){"
"0","  sum <- as.data.frame(sapply(dataset[, names(dataset) %in% var], sum))"
"0","  sum <- cbind(rownames(sum), sum)"
"0","  filtered <- sum[sum[,2] > 0,1]"
"0","  tab <- as.data.frame(sapply(dataset[,names(dataset) %in% filtered], table, dataset[, strata]))"
"0","  ntab <- names(tab)"
"0","  #if the absence of empty cells for each strata is needed, per_cell = T"
"0","  tab <- tab[, which(colnames(tab) %in% ntab)]"
"0","  zeros <- apply(apply(tab, 2, function(x) x==0), 2, any)"
"0","  zeros <- zeros[zeros == F]"
"0","  zeros <- as.data.frame(zeros)"
"0","  zeros <- cbind(rownames(zeros), zeros)"
"0","  zeros_lab <- as.vector(unlist(strsplit(zeros[,1], split = "".Freq"")))"
"0","  result <- c()"
"0","  if(per_cell == T){"
"0","    result <- zeros_lab"
"0","  } else {"
"0","    result <- ntab"
"0","  }"
"0","  message(paste0(abs(length(var) - length(result)), "" variables were removed because of containing zeros in stratas""))"
"0","  "
"0","  return(result)"
"0","}"
